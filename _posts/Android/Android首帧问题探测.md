## 	权限情况：
	
* 	定位 ：MT店铺
*  拍照 ：人身识别
*  网络及网络状态 ：上网
*  震动：推送等通知反馈
*  闪光灯:扫码补光
	
### Android 7
	
	2021-12-02 09:47:28.216 14371-14371/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.MainActivity@847eee410330397
	2021-12-02 09:47:28.217 14371-14371/com.snail.labaffinity V/Collie: onPause com.snail.labaffinity.activity.MainActivity@847eee410330398
	2021-12-02 09:47:28.245 14371-14371/com.snail.labaffinity V/Collie: onResume com.snail.labaffinity.activity.LauncherTestActivity@4d2977610330426
	2021-12-02 09:47:28.245 14371-14371/com.snail.labaffinity V/Collie: onPostResumemcom.snail.labaffinity.activity.LauncherTestActivity@4d2977610330426
	2021-12-02 09:47:28.252 14371-14371/com.snail.labaffinity V/Collie: onAttachedToWindow
	2021-12-02 09:47:29.281 14371-14371/com.snail.labaffinity V/Collie: onDraw
	2021-12-02 09:47:30.293 14371-14371/com.snail.labaffinity V/Collie: onWindowFocusChanged
	2021-12-02 09:47:30.293 14371-14371/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.LauncherTestActivity@4d2977610332474
	2021-12-02 09:47:31.294 14371-14371/com.snail.labaffinity V/Collie: onWindowFocusChanged   慢
	2021-12-02 09:47:31.295 14371-14371/com.snail.labaffinity V/Collie: Activity 获取焦点com.snail.labaffinity.activity.LauncherTestActivity@4d29776 3078
	2021-12-02 09:47:31.298 14371-14447/com.snail.labaffinity V/Collie: activity启动耗时 com.snail.labaffinity.activity.LauncherTestActivity@4d29776 3080 finishNow false
	2021-12-02 09:47:31.326 14371-14371/com.snail.labaffinity V/Collie: onStop com.snail.labaffinity.activity.MainActivity@847eee410333507
	2021-12-02 09:47:31.718 14371-14447/com.snail.labaffinity V/Collie: 内存  com.snail.labaffinity java内存  5 native内存  9
	
### 	Android 8

	2021-12-02 10:33:43.004 3470-3470/com.snail.labaffinity V/Collie: onPause com.snail.labaffinity.activity.MainActivity@d6ec83f114614
	2021-12-02 10:33:43.036 3470-3470/com.snail.labaffinity V/Collie: onResume com.snail.labaffinity.activity.LauncherTestActivity@73be63f114646
	2021-12-02 10:33:43.037 3470-3470/com.snail.labaffinity V/Collie: onPostResumemcom.snail.labaffinity.activity.LauncherTestActivity@73be63f114646
	2021-12-02 10:33:43.045 3470-3470/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.MainActivity@d6ec83f114655
	2021-12-02 10:33:43.051 3470-3470/com.snail.labaffinity V/Collie: onAttachedToWindow
	2021-12-02 10:33:44.098 3470-3470/com.snail.labaffinity V/Collie: onDraw
	2021-12-02 10:33:45.108 3470-3470/com.snail.labaffinity V/Collie: onWindowFocusChanged
	2021-12-02 10:33:45.108 3470-3470/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.LauncherTestActivity@73be63f116717
	2021-12-02 10:33:46.110 3470-3470/com.snail.labaffinity V/Collie: onWindowFocusChanged   慢
	2021-12-02 10:33:46.111 3470-3470/com.snail.labaffinity V/Collie: Activity 获取焦点com.snail.labaffinity.activity.LauncherTestActivity@73be63f 3107
	2021-12-02 10:33:46.113 3470-3516/com.snail.labaffinity V/Collie: activity启动耗时 com.snail.labaffinity.activity.LauncherTestActivity@73be63f 3109 finishNow false
	2021-12-02 10:33:46.131 3470-3470/com.snail.labaffinity V/Collie: onStop com.snail.labaffinity.activity.MainActivity@d6ec83f117741
	2021-12-02 10:33:49.977 3470-3516/com.snail.labaffinity V/Collie: 内存  com.snail.labaffinity java内存  2 native内存  9


### Android8.1

![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/452627de247f465eb494f7b47f64c02c~tplv-k3u1fbpfcp-watermark.image?)



	2021-12-02 10:28:35.169 3663-3663/com.snail.labaffinity V/Collie: onPause com.snail.labaffinity.activity.MainActivity@f85174494367
	2021-12-02 10:28:35.208 3663-3663/com.snail.labaffinity V/Collie: onResume com.snail.labaffinity.activity.LauncherTestActivity@d038b8a94405
	2021-12-02 10:28:35.208 3663-3663/com.snail.labaffinity V/Collie: onPostResumemcom.snail.labaffinity.activity.LauncherTestActivity@d038b8a94406
	2021-12-02 10:28:35.219 3663-3663/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.MainActivity@f85174494417
	2021-12-02 10:28:35.223 3663-3663/com.snail.labaffinity V/Collie: onAttachedToWindow
	2021-12-02 10:28:36.263 3663-3663/com.snail.labaffinity V/Collie: onDraw
	2021-12-02 10:28:37.277 3663-3663/com.snail.labaffinity V/Collie: onWindowFocusChanged
	2021-12-02 10:28:37.277 3663-3663/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.LauncherTestActivity@d038b8a96476
	2021-12-02 10:28:37.429 3663-3733/com.snail.labaffinity V/Collie: 内存  com.snail.labaffinity java内存  2 native内存  10
	2021-12-02 10:28:38.279 3663-3663/com.snail.labaffinity V/Collie: onWindowFocusChanged   慢
	2021-12-02 10:28:38.279 3663-3663/com.snail.labaffinity V/Collie: Activity 获取焦点com.snail.labaffinity.activity.LauncherTestActivity@d038b8a 3110
	2021-12-02 10:28:38.282 3663-3733/com.snail.labaffinity V/Collie: activity启动耗时 com.snail.labaffinity.activity.LauncherTestActivity@d038b8a 3113 finishNow false
	2021-12-02 10:28:38.299 3663-3663/com.snail.labaffinity V/Collie: onStop com.snail.labaffinity.activity.MainActivity@f85174497497

 
### android 9 无固定顺序

> ResumeActivityItem


    @Override
    public void execute(ClientTransactionHandler client, IBinder token,
            PendingTransactionActions pendingActions) {
        Trace.traceBegin(TRACE_TAG_ACTIVITY_MANAGER, "activityResume");
        client.handleResumeActivity(token, true /* finalStateRequest */, mIsForward,
                "RESUME_ACTIVITY");
        Trace.traceEnd(TRACE_TAG_ACTIVITY_MANAGER);
    }

    @Override
    public void postExecute(ClientTransactionHandler client, IBinder token,
            PendingTransactionActions pendingActions) {
        try {
            // TODO(lifecycler): Use interface callback instead of AMS.
            ActivityTaskManager.getService().activityResumed(token);
        } catch (RemoteException ex) {
            throw ex.rethrowFromSystemServer();
        }
    }
    




 onWindowFocusChanged与UI绘制的时机并无严格先后，onWindowFocusChanged收到WMS管理，是窗口焦点问题，第一次执行perfortraval，可能窗口还不可见，因为某些问题，后到来

![image.png](https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d43e9d7867cc4e0eb46ae09de2800e72~tplv-k3u1fbpfcp-watermark.image?)


  类型1： 先draw，后focus

	
	2021-12-02 10:04:23.393 24333-24333/com.snail.labaffinity V/Collie: onPostResumemcom.snail.labaffinity.activity.LauncherTestActivity@2ea11b748769668
	2021-12-02 10:04:23.406 24333-24333/com.snail.labaffinity V/Collie: onAttachedToWindow
	2021-12-02 10:04:24.465 24333-24333/com.snail.labaffinity V/Collie: onDraw
	2021-12-02 10:04:25.483 24333-24333/com.snail.labaffinity V/Collie: onWindowFocusChanged
	2021-12-02 10:04:25.483 24333-24333/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.LauncherTestActivity@2ea11b748771758
	2021-12-02 10:04:26.484 24333-24333/com.snail.labaffinity V/Collie: onWindowFocusChanged   慢
	2021-12-02 10:04:26.486 24333-24333/com.snail.labaffinity V/Collie: Activity 获取焦点com.snail.labaffinity.activity.LauncherTestActivity@2ea11b7 3366
	2021-12-02 10:04:26.512 24333-24406/com.snail.labaffinity V/Collie: activity启动耗时 com.snail.labaffinity.activity.LauncherTestActivity@2ea11b7 3392 finishNow false
	2021-12-02 10:04:26.581 24333-24406/com.snail.labaffinity V/Collie: Activity com.snail.labaffinity.activity.LauncherTestActivity@2ea11b7 掉帧 2 是否因为Choro 绘制掉帧 true 1s 平均帧率46
	2021-12-02 10:04:26.590 24333-24333/com.snail.labaffinity V/Collie: onStop com.snail.labaffinity.activity.MainActivity@379727c48772864
	2021-12-02 10:04:26.642 24333-24333/com.snail.labaffinity V/Collie: MainActivity 流量消耗 0.0M
	2021-12-02 10:04:26.642 24333-24333/com.snail.labaffinity V/Collie: onDestroy com.snail.labaffinity.activity.MainActivity@379727c48772917
	
类型2： 先draw，后focus
	  
	2021-12-02 10:54:35.513 28156-28156/com.snail.labaffinity V/Collie: onResume com.snail.labaffinity.activity.LauncherTestActivity@ceab24350815759
	2021-12-02 10:54:35.514 28156-28156/com.snail.labaffinity V/Collie: onPostResumemcom.snail.labaffinity.activity.LauncherTestActivity@ceab24350815759
	2021-12-02 10:54:35.521 28156-28156/com.snail.labaffinity V/Collie: onAttachedToWindow
	2021-12-02 10:54:37.054 28156-28156/com.snail.labaffinity V/Collie: onDraw
	2021-12-02 10:54:37.055 28156-28220/com.snail.labaffinity V/Collie: activity启动耗时 com.snail.labaffinity.activity.LauncherTestActivity@ceab243 1589 finishNow false
	2021-12-02 10:54:38.075 28156-28156/com.snail.labaffinity V/Collie: onWindowFocusChanged
	2021-12-02 10:54:38.075 28156-28156/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.LauncherTestActivity@ceab24350818321
	2021-12-02 10:54:39.077 28156-28156/com.snail.labaffinity V/Collie: onWindowFocusChanged   慢
	2021-12-02 10:54:39.578 28156-28156/com.snail.labaffinity V/Collie: Activity 获取焦点com.snail.labaffinity.activity.LauncherTestActivity@ceab243 4112
	2021-12-02 10:54:39.607 28156-28156/com.snail.labaffinity V/Collie: onStop com.snail.labaffinity.activity.MainActivity@da842ba50819852
	2021-12-02 10:54:39.618 28156-28156/com.snail.labaffinity V/Collie: MainActivity 流量消耗 0.0M
	2021-12-02 10:54:39.619 28156-28156/com.snail.labaffinity V/Collie: onDestroy com.snail.labaffinity.activity.MainActivity@da842ba50819864

类型3：先focus，后draw

	 2021-12-02 11:20:47.643 589-589/com.snail.labaffinity V/Collie: onPostResumemcom.snail.labaffinity.activity.LauncherTestActivity@9e8e94f52387888
	2021-12-02 11:20:47.911 589-589/com.snail.labaffinity V/Collie: onAttachedToWindow
	2021-12-02 11:20:48.441 589-589/com.snail.labaffinity V/Collie: onWindowFocusChanged
	2021-12-02 11:20:48.444 589-589/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.LauncherTestActivity@9e8e94f52388689
	2021-12-02 11:20:48.755 589-589/com.snail.labaffinity V/Collie: onWindowFocusChanged   慢
	2021-12-02 11:20:48.763 589-589/com.snail.labaffinity V/Collie: Activity 获取焦点com.snail.labaffinity.activity.LauncherTestActivity@9e8e94f 2802
	2021-12-02 11:20:49.126 589-589/com.snail.labaffinity V/Collie: onDraw
	2021-12-02 11:20:49.306 589-652/com.snail.labaffinity V/Collie: activity启动耗时 com.snail.labaffinity.activity.LauncherTestActivity@9e8e94f 3334 finishNow false
	2021-12-02 11:20:49.718 589-652/com.snail.labaffinity V/Collie: Activity com.snail.labaffinity.activity.LauncherTestActivity@9e8e94f 掉帧 5 是否因为Choro 绘制掉帧 false 1s 平均帧率10
	

### android 10 以后有重大变化，优先处理绘制，onReusme或者onCreate post一个效果一样
     

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/558a22fcfdb54aa3a79cbf7d7327ef2c~tplv-k3u1fbpfcp-watermark.image?)

一次

![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4e7c2238df03459a8431f45af61bc70f~tplv-k3u1fbpfcp-watermark.image?)


	2021-12-02 09:49:20.966 10722-10722/com.snail.labaffinity V/Collie: onPause com.snail.labaffinity.activity.MainActivity@cee5428300315573
	2021-12-02 09:49:21.030 10722-10722/com.snail.labaffinity V/Collie: onResume com.snail.labaffinity.activity.LauncherTestActivity@1248aac300315637
	2021-12-02 09:49:21.030 10722-10722/com.snail.labaffinity V/Collie: onPostResumemcom.snail.labaffinity.activity.LauncherTestActivity@1248aac300315638
	2021-12-02 09:49:21.066 10722-10722/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.MainActivity@cee5428300315674
	2021-12-02 09:49:21.070 10722-10722/com.snail.labaffinity V/Collie: onAttachedToWindow
	2021-12-02 09:49:22.097 10722-10722/com.snail.labaffinity V/Collie: onDraw
	2021-12-02 09:49:22.118 10722-10791/com.snail.labaffinity V/Collie: activity启动耗时 com.snail.labaffinity.activity.LauncherTestActivity@1248aac 1152 finishNow false
	2021-12-02 09:49:23.118 10722-10722/com.snail.labaffinity V/Collie: onWindowFocusChanged
	2021-12-02 09:49:23.118 10722-10722/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.LauncherTestActivity@1248aac300317726
	2021-12-02 09:49:24.119 10722-10722/com.snail.labaffinity V/Collie: onWindowFocusChanged   慢
	2021-12-02 09:49:24.119 10722-10722/com.snail.labaffinity V/Collie: Activity 获取焦点com.snail.labaffinity.activity.LauncherTestActivity@1248aac 3154
	2021-12-02 09:49:24.169 10722-10722/com.snail.labaffinity V/Collie: onStop com.snail.labaffinity.activity.MainActivity@cee5428300318776


### android11

	2021-12-02 10:22:31.774 9558-9558/com.snail.labaffinity V/Collie: onPause com.snail.labaffinity.activity.MainActivity@6ea3a811060618
	2021-12-02 10:22:31.842 9558-9558/com.snail.labaffinity V/Collie: onResume com.snail.labaffinity.activity.LauncherTestActivity@284f20e1060687
	2021-12-02 10:22:31.844 9558-9558/com.snail.labaffinity V/Collie: onPostResumemcom.snail.labaffinity.activity.LauncherTestActivity@284f20e1060689
	2021-12-02 10:22:31.862 9558-9558/com.snail.labaffinity V/Collie: onAttachedToWindow
	2021-12-02 10:22:32.898 9558-9558/com.snail.labaffinity V/Collie: onDraw
	2021-12-02 10:22:32.917 9558-9558/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.MainActivity@6ea3a811061762
	2021-12-02 10:22:32.919 9558-9704/com.snail.labaffinity V/Collie: activity启动耗时 com.snail.labaffinity.activity.LauncherTestActivity@284f20e 1145 finishNow false
	2021-12-02 10:22:33.946 9558-9558/com.snail.labaffinity V/Collie: onWindowFocusChanged
	2021-12-02 10:22:33.946 9558-9558/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.LauncherTestActivity@284f20e1062791
	2021-12-02 10:22:34.947 9558-9558/com.snail.labaffinity V/Collie: onWindowFocusChanged   慢
	2021-12-02 10:22:34.948 9558-9558/com.snail.labaffinity V/Collie: Activity 获取焦点com.snail.labaffinity.activity.LauncherTestActivity@284f20e 3175
	2021-12-02 10:22:34.960 9558-9558/com.snail.labaffinity V/Collie: onStop com.snail.labaffinity.activity.MainActivity@6ea3a811063805

### android 12

	2021-12-02 10:21:32.908 28713-28713/com.snail.labaffinity V/Collie: onPause com.snail.labaffinity.activity.MainActivity@925ebd3554344824
	2021-12-02 10:21:32.937 28713-28713/com.snail.labaffinity V/Collie: onResume com.snail.labaffinity.activity.LauncherTestActivity@18bab5a554344853
	2021-12-02 10:21:32.937 28713-28713/com.snail.labaffinity V/Collie: onPostResumemcom.snail.labaffinity.activity.LauncherTestActivity@18bab5a554344853
	2021-12-02 10:21:32.945 28713-28713/com.snail.labaffinity V/Collie: onAttachedToWindow
	2021-12-02 10:21:33.957 28713-28713/com.snail.labaffinity V/Collie: onDraw
	2021-12-02 10:21:33.963 28713-28713/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.MainActivity@925ebd3554345879
	2021-12-02 10:21:33.965 28713-28759/com.snail.labaffinity V/Collie: activity启动耗时 com.snail.labaffinity.activity.LauncherTestActivity@18bab5a 1057 finishNow false
	2021-12-02 10:21:34.978 28713-28713/com.snail.labaffinity V/Collie: onWindowFocusChanged
	2021-12-02 10:21:34.979 28713-28713/com.snail.labaffinity V/Collie: onWindowFocusChanged com.snail.labaffinity.activity.LauncherTestActivity@18bab5a554346895
	2021-12-02 10:21:35.979 28713-28713/com.snail.labaffinity V/Collie: onWindowFocusChanged   慢
	2021-12-02 10:21:35.980 28713-28713/com.snail.labaffinity V/Collie: Activity 获取焦点com.snail.labaffinity.activity.LauncherTestActivity@18bab5a 3072
	2021-12-02 10:21:35.994 28713-28713/com.snail.labaffinity V/Collie: onStop com.snail.labaffinity.activity.MainActivity@925ebd3554347910
	 
	 
### Button与TextView产生的效果不同	 
	 
	12-03 10:39:04.259 29286 29286 V Collie  : onDraw
	12-03 10:39:04.561 29286 29286 V Collie  : onDraw
	12-03 10:39:04.870 29286 29286 V Collie  : onActivityResumed +++ com.snail.testlaunch.SecondActivity@ec4362b
	12-03 10:39:11.315 29286 29286 V Collie  : onDraw
	12-03 10:39:11.619 29286 29286 V Collie  : onDraw
	12-03 10:39:11.930 29286 29286 V Collie  : onActivityResumed +++ com.snail.testlaunch.SecondActivity@6818469
	12-03 10:39:33.692 29414 29414 V Collie  : onActivityResumed +++ com.snail.testlaunch.SecondActivity@2aed099
	12-03 10:39:34.021 29414 29414 V Collie  : onDraw
	12-03 10:39:34.324 29414 29414 V Collie  : onDraw
	
	
	理论上来说，Onresume之后的第一个消息是在Draw之前执行的，但是可能有例外
	
![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/441ed56238664d2c9d2443de540224de~tplv-k3u1fbpfcp-watermark.image?)	 



![image.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/7f9b2a9052a2433586bfc2b0ff48f81a~tplv-k3u1fbpfcp-watermark.image?)



![image.png](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/66a193d5d31744039f4b90e82f86b263~tplv-k3u1fbpfcp-watermark.image?)
