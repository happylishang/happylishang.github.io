---
layout: post
title: "Gradle使用学习"
categories: [Groovy]

--- 

# 简单创建task

* 1 直接用Project中的方法创建

	task hello1 << {
	   println 'hello1'
	}

<<”表示追加的意思，即向hello中加入执行过程

	task hello2 {
	   doLast {
	      println 'hello2'}
	}
	
上面的task关键字实际上是一个方法调用，该方法属于Project。

* 2 通过TaskContainer的create()方法创建Task



在上文中我们讲到，通过task()方法创建的Task都被存放在了TaskContainer中，而Project又维护了一个TaskContainer类型的属性tasks，那么我们完全可以直接向TaskContainer里面添加Task。查查TaskContainer的API文档可以发现，TaskContainer向我们提供了大量重载的create()方法用于添加Task。

	tasks.create(name: 'hello4') << {
	   println 'hello4'
	}
	
* 3 声明Task之间的依赖关系

Task之间是可以存在依赖关系，比如TaskA依赖TaskB，那么在执行TaskA时，Gradle会先执行TaskB，再执行TaskA。我们可以在定义一个Task的同时声明它的依赖关系：

	task hello5(dependsOn:hello4) << {
	    println 'hello5'
	}
 
　　当然，我们也可以在定义Task之后再声明依赖：

	task hello6 << {
	   println 'hello6'
	}
	
	hello6.dependsOn hello5
	
# 配置Task

写相同的Closure名称，就在里面配置就可以

	showTime {
	    println "showTime Config "
	
	}
	
//当前project task 复用一个Project

	class DateAndTimePlugin implements Plugin<Project> {
	    void apply(Project project) {
	
	//        动态创建内部Field
	
	        project.extensions.create("dateAndTime", DateAndTimePluginExtension)
	
	//        创建了两个task
	        project.task('showTime') << {
	            println "Current time is " + new Date().format(project.dateAndTime.timeFormat)
	        }
	 }
	        
	        
对于Anroid来说也是如此 在AppPlugin中又很直观的体现只不过是配置对象

        def buildTypeContainer = project.container(DefaultBuildType,
                new BuildTypeFactory(instantiator,  project.fileResolver))
        def productFlavorContainer = project.container(GroupableProductFlavorDsl,
                new GroupableProductFlavorFactory(instantiator, project.fileResolver))
        def signingConfigContainer = project.container(SigningConfig,
                new SigningConfigFactory(instantiator))

        extension = project.extensions.create('android', AppExtension,
                this, (ProjectInternal) project, instantiator,
                buildTypeContainer, productFlavorContainer, signingConfigContainer)
        setBaseExtension(extension)
	        
这就是app的build.gradle可以设置android{}的原因。其实就是动态配置AppExtension对象，也许这样写更好理解

	android {
	    compileSdkVersion(23);
	    buildToolsVersion("23.0.3");	    
或者

	android {
	compileSdkVersion=23
	buildToolsVersion="23.0.3"
	        
        	        