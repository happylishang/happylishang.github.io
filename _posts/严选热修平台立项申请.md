## 背景

APP端线上问题不可避免，如何快速响应解决线上问题是降损必不可少的一环节，比如大量Crash或者埋点错误等，解决这些意义重大。目前各大友商都有相应的热修方案，严选目前虽然Android上线了部分tinker热修，但是使用上存在诸多问题，需要重新整合，做一个比较完善好用的系统，长久来看，意义重大。

## 热修收益

如果采用发版修复的流程，从问题发生到问题解决，中间经历的时间其实是非常长的，因为牵扯一个上架及更新的过程，目前从修复到上架的耗时如下：

![](https://user-gold-cdn.xitu.io/2020/7/20/1736a08123fdc2be?w=636&h=333&f=png&s=21680)


可以看到基本上至少需要5到6天才能修复一个问题，而在这5-6天中，问题会不断积累，尤其是 错误数据会不断给产品带来影响，而热修最大的作用就是将修复的跨度缩减，同时还会带来其他一些优化，如下做个简单对比：


方案       | 修复速度              |    用户体验                     |   数据统计及投放
--------------------|------------------| ------------------| ------------------| 
发版 | 发版、上架、升级至少5-6天 | 用户需要主动升级 |  业务方需要重新整合版本号
热修 | APP启动即可完成修复 |  用户无感知| 业务方无需任何修改
 
## 友商案例

* 腾讯：tinker、QQ热修方案 
* 美团：Robust
* 阿里：AndFix、Hotpatch  

##  严选热修平台能力简述

#### 基础热修能力

主要包含差分包上传、删除、参数订制等能力

#### 热修包回退能力

如果线上热修包出现问题，需要提供回退能力，避免二次破坏。

#### 灰度发布能力

能根据不同人群，定向投放热修包，力度包含但不限制如下：

* 按版本
* 按系统
* 按平台
* 按账号
* 按流量 

####  数据统计分析能力

主要用来查看热修量、热修效果、版本记录等。

* 修复记录
* 下载量
* 生效率 
 
## 严选热修平台实现方案

该方案主要包含APP端及后端（包含后台管理系统）

#### APP端方案：

主要是提供热修包创建、下载、加载逻辑，目前可选方案如下：

* android  tinker or robust
* ios MangoFix LUA

后端需提供能力：

* 灰度能力
* 数据统计能力
* 报表能力
* 基础后台管理能力

## 推进及上线

Q3落地上线

![](https://user-gold-cdn.xitu.io/2020/7/20/1736b5728849c6c1?w=1095&h=636&f=png&s=46912)

## 最终上线后产出物

* 各端技术方案
* 修复流程白皮书
* 后台使用规范
* 报表查看规范
